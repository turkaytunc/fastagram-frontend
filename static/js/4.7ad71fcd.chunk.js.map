{"version":3,"sources":["hooks/useAuth.ts","routes/login/Login.tsx"],"names":["useAuth","path","userContext","useContext","UserContext","history","useHistory","useEffect","a","validateUser","response","json","data","message","setUser","user","push","localStorage","removeItem","fetchUser","Login","useState","email","setEmail","password","setPassword","inputError","setInputError","showPassword","setShowPassword","document","title","handleLogin","event","preventDefault","loginValidator","login","window","setItem","token","className","src","instagramLogo","alt","type","onSubmit","e","testId","item","setError","isPassword","placeholder","data-testid","onClick","prev","to","style","backgroundColor","length","disabled"],"mappings":"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","file":"static/js/4.7ad71fcd.chunk.js","sourcesContent":["import { useContext, useEffect } from 'react';\nimport { validateUser } from 'src/api';\nimport { UserContext } from 'src/context/UserContext';\nimport { useHistory } from 'react-router-dom';\n\nexport default function useAuth(path: string) {\n  const userContext = useContext(UserContext);\n  const history = useHistory();\n\n  useEffect(() => {\n    const fetchUser = async () => {\n      try {\n        const response = await validateUser();\n        const data = await response.json();\n\n        if (!data.message) {\n          userContext?.setUser(data.user);\n          history.push(`${path}`);\n          return;\n        }\n        userContext?.setUser(null);\n        localStorage.removeItem('auth');\n        history.push('/login');\n        return;\n      } catch (error) {\n        userContext?.setUser(null);\n        localStorage.removeItem('auth');\n        history.push('/login');\n      }\n    };\n    fetchUser();\n  }, []);\n}\n","import React, { useContext, useEffect, useState } from 'react';\nimport { useHistory, Link } from 'react-router-dom';\nimport './login.scss';\nimport { FaFacebookSquare } from 'react-icons/fa';\nimport { loginValidator } from 'src/helpers/joiValidators';\nimport instagramLogo from 'src/images/instagram-login.png';\nimport { FakePhoneScreen, InputBox } from 'src/components';\nimport { login } from 'src/api';\nimport { UserContext } from 'src/context/UserContext';\nimport useAuth from 'src/hooks/useAuth';\n\nconst Login = () => {\n  const [email, setEmail] = useState('');\n  const [password, setPassword] = useState('');\n  const [inputError, setInputError] = useState('');\n  const [showPassword, setShowPassword] = useState(true);\n  const user = useContext(UserContext);\n  const history = useHistory();\n  useAuth('/');\n\n  useEffect(() => {\n    document.title = 'Login â€¢ Instagram';\n  }, []);\n\n  const handleLogin = async (event: React.FormEvent<HTMLFormElement>) => {\n    event.preventDefault();\n\n    try {\n      await loginValidator(email, password);\n      const response = await login(email, password);\n\n      const data = await response.json();\n\n      if (data.message) {\n        setInputError(data.message);\n        return;\n      }\n      user?.setUser(data.user);\n      window.localStorage.setItem('auth', data.token);\n      history.push('/');\n    } catch (error) {\n      setInputError(error.message);\n    }\n  };\n\n  return (\n    <section className=\"flex justify-center\">\n      <div className=\"hidden lg:block\">\n        <FakePhoneScreen />\n      </div>\n      <section className=\"login-container md:border md:border-gray-300 p-10\">\n        <img className=\"w-48\" src={instagramLogo} alt=\"instagram\" />\n        <div className=\"my-7\">\n          <button type=\"button\" className=\"form-button flex justify-center items-center\">\n            <FaFacebookSquare className=\"mr-2\" />\n            Continue with Facebook\n          </button>\n        </div>\n        <div className=\"relative border-t border-gray-300 w-68\">\n          <span className=\"absolute -top-2 bg-gray-50 text-gray-400 w-14 left-28 text-sm\">OR</span>\n        </div>\n        <form onSubmit={(e) => handleLogin(e)}>\n          <InputBox\n            testId=\"login-email\"\n            item={email}\n            setItem={setEmail}\n            setError={setInputError}\n            isPassword={false}\n            placeholder=\"Email\"\n          />\n\n          <div className=\"flex w-68 mt-2 rounded-sm\">\n            <InputBox\n              testId=\"login-password\"\n              item={password}\n              setItem={setPassword}\n              setError={setInputError}\n              isPassword={showPassword}\n              placeholder=\"Password\"\n            />\n            <div className=\"w-12 border mt-2 border-l-0 rounded-sm\">\n              <button\n                data-testid=\"login-show-hide\"\n                className=\"w-full h-10 text-sm font-medium\"\n                type=\"button\"\n                onClick={() => setShowPassword((prev) => !prev)}\n              >\n                {showPassword ? 'Show' : 'Hide'}\n              </button>\n            </div>\n          </div>\n          <div className=\"w-68 text-right mt-3 font-light\">\n            <Link className=\"text-sm \" to=\"/login\">\n              Forgot password?\n            </Link>\n          </div>\n          <button\n            style={{\n              backgroundColor: `${\n                email.length > 5 && password.length > 5 ? '#0095f6' : 'rgba(0,149,246,.3)'\n              }`,\n            }}\n            className=\"form-button\"\n            type=\"submit\"\n            disabled={email.length < 5 || password.length < 5}\n          >\n            Log in\n          </button>\n        </form>\n        {inputError && <div className=\"mt-5 w-68 text-red-500 text-sm\">{inputError}</div>}\n        <div className=\"text-sm w-68 text-gray-400 mt-5\">\n          Don't have an account? <Link to=\"/signup\">Sign up</Link>\n        </div>\n      </section>\n      <div>{user?.user?.email}</div>\n    </section>\n  );\n};\nexport default Login;\n"],"sourceRoot":""}