{"version":3,"sources":["hooks/useAuth.ts","helpers/timeoutPromise.ts","routes/dashboard/Dashboard.tsx"],"names":["useAuth","path","userContext","useContext","UserContext","history","useHistory","useEffect","a","validateUser","response","json","data","message","setUser","user","push","localStorage","removeItem","fetchUser","timeout","prom","time","Promise","race","_r","rej","setTimeout","Dashboard","useState","user_id","id","feedItems","setFeedItems","isMounted","fetchFeedItems","fetchFeed","document","title","className","length","map","el","photoId","imageData","userId","Math","random"],"mappings":"yNAKe,SAASA,EAAQC,GAC9B,IAAMC,EAAcC,qBAAWC,KACzBC,EAAUC,cAEhBC,qBAAU,YACO,uCAAG,8BAAAC,EAAA,+EAESC,cAFT,cAERC,EAFQ,gBAGKA,EAASC,OAHd,WAGRC,EAHQ,QAKJC,QALI,wBAMD,OAAXX,QAAW,IAAXA,KAAaY,QAAQF,EAAKG,MAC1BV,EAAQW,KAAR,UAAgBf,IAPJ,kCAUH,OAAXC,QAAW,IAAXA,KAAaY,QAAQ,MACrBG,aAAaC,WAAW,QACxBb,EAAQW,KAAK,UAZC,qDAeH,OAAXd,QAAW,IAAXA,KAAaY,QAAQ,MACrBG,aAAaC,WAAW,QACxBb,EAAQW,KAAK,UAjBC,0DAAH,qDAoBfG,KACC,M,2IC/BQC,EAAU,SAACC,EAAoBC,GAArB,OACrBC,QAAQC,KAAK,CAACH,EAAM,IAAIE,SAAQ,SAACE,EAAIC,GAAL,OAAaC,WAAWD,EAAKJ,S,OCkEhDM,UAxDG,WAChB5B,YAAQ,KACR,IAAMK,EAAUC,cAEhB,EAAkCuB,mBAAS,CAAC,CAAEC,QAAS,GAAIC,GAAI,GAAInB,KAAM,MAAzE,mBAAOoB,EAAP,KAAkBC,EAAlB,KA4BA,OAxBA1B,qBAAU,WACR,IAAI2B,GAAY,EAchB,OAbe,uCAAG,8BAAA1B,EAAA,+EAESY,EAAQe,cAAkB,KAFnC,cAERzB,EAFQ,gBAGKA,EAASC,OAHd,OAGRC,EAHQ,OAKVsB,GACFD,EAAarB,EAAKoB,WANN,kDASd3B,EAAQW,KAAK,UATC,0DAAH,oDAYfoB,GACO,WACLF,GAAY,KAEb,IAEH3B,qBAAU,WACR8B,SAASC,MAAQ,cAChB,IAGD,sBAAKC,UAAU,sBAAf,UACE,cAAC,IAAD,KACU,OAATP,QAAS,IAATA,OAAA,EAAAA,EAAWQ,QAAS,GAA2B,KAAtBR,EAAU,GAAGpB,KACrC,sBAAK2B,UAAU,iBAAf,UACE,qBAAKA,UAAU,aAAf,gBACGP,QADH,IACGA,OADH,EACGA,EAAWS,KAAI,SAACC,GAAD,OACd,cAAC,IAAD,CAEEC,QAASD,EAAGX,GACZa,UAAWF,EAAG9B,KACdiC,OAAQH,EAAGZ,SAHNY,EAAGX,IAAMe,KAAKC,eAOzB,cAAC,IAAD,OAGF,cAAC,IAAD","file":"static/js/3.4551aa1d.chunk.js","sourcesContent":["import { useContext, useEffect } from 'react';\nimport { validateUser } from 'src/api';\nimport { UserContext } from 'src/context/UserContext';\nimport { useHistory } from 'react-router-dom';\n\nexport default function useAuth(path: string) {\n  const userContext = useContext(UserContext);\n  const history = useHistory();\n\n  useEffect(() => {\n    const fetchUser = async () => {\n      try {\n        const response = await validateUser();\n        const data = await response.json();\n\n        if (!data.message) {\n          userContext?.setUser(data.user);\n          history.push(`${path}`);\n          return;\n        }\n        userContext?.setUser(null);\n        localStorage.removeItem('auth');\n        history.push('/login');\n        return;\n      } catch (error) {\n        userContext?.setUser(null);\n        localStorage.removeItem('auth');\n        history.push('/login');\n      }\n    };\n    fetchUser();\n  }, []);\n}\n","export const timeout = (prom: Promise<any>, time: number) =>\n  Promise.race([prom, new Promise((_r, rej) => setTimeout(rej, time))]);\n","/* eslint-disable camelcase */\n/* eslint-disable dot-notation */\nimport { useEffect, useState } from 'react';\nimport { FeedItem, FeedSidebar, Loading, Navbar } from 'src/components';\nimport './dashboard.scss';\nimport { useHistory } from 'react-router-dom';\n\nimport useAuth from 'src/hooks/useAuth';\nimport { fetchFeedItems } from 'src/api';\nimport { timeout } from 'src/helpers/timeoutPromise';\n\nconst Dashboard = () => {\n  useAuth('/');\n  const history = useHistory();\n\n  const [feedItems, setFeedItems] = useState([{ user_id: '', id: '', data: '' }] as [\n    { user_id: string; id: string; data: string }\n  ]);\n\n  useEffect(() => {\n    let isMounted = true;\n    const fetchFeed = async () => {\n      try {\n        const response = await timeout(fetchFeedItems(), 4000);\n        const data = await response.json();\n\n        if (isMounted) {\n          setFeedItems(data.feedItems);\n        }\n      } catch (error) {\n        history.push('/login');\n      }\n    };\n    fetchFeed();\n    return () => {\n      isMounted = false;\n    };\n  }, []);\n\n  useEffect(() => {\n    document.title = 'Instagram';\n  }, []);\n\n  return (\n    <div className=\"dashboard-container\">\n      <Navbar />\n      {feedItems?.length > 0 && feedItems[0].data !== '' ? (\n        <div className=\"dashboard-feed\">\n          <div className=\"feed-photo\">\n            {feedItems?.map((el) => (\n              <FeedItem\n                key={el.id || Math.random()}\n                photoId={el.id}\n                imageData={el.data}\n                userId={el.user_id}\n              />\n            ))}\n          </div>\n          <FeedSidebar />\n        </div>\n      ) : (\n        <Loading />\n      )}\n    </div>\n  );\n};\n\nexport default Dashboard;\n"],"sourceRoot":""}